name: Update Idea Status

on:
   schedule:
      # Run every 15 minutes to check for completed jobs
      - cron: "*/15 * * * *"
   workflow_dispatch: # Allow manual triggering

jobs:
   update-status:
      runs-on: ubuntu-latest
      permissions:
         issues: write
         contents: read

      steps:
         - name: Checkout repository
           uses: actions/checkout@v4
         - name: Set up bun
           uses: oven-sh/setup-bun@v1
         - name: Install dependencies
           run: bun install
         - name: Check and update issue status
           env:
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              GITHUB_REPOSITORY: ${{ github.repository }}
              IDEA_EXPLORER_API_URL: ${{ secrets.IDEA_EXPLORER_API_URL }}
              IDEA_EXPLORER_API_TOKEN: ${{ secrets.IDEA_EXPLORER_API_TOKEN }}
           run: bun run scripts/gh/update-idea-status.ts
